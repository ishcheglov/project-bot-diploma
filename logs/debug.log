2023-06-09T20:54:51.363809+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (11855), thread 'WorkerThread1' (140475307112128):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f4422bc0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fc2f5edf240>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fc2f5d98720>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fc2f4d3f2e0>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fc2f4dfa250>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fc2f5e33450>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fc2f4dfa250>
             └ {'function': <function bot_start at 0x7fc2f44059e0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fc2f4dfa250>
    └ <function save_user at 0x7fc2f43ab600>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fc2f4db7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │      └ <peewee.ModelInsert object at 0x7fc2f5e59a50>
           └ <function BaseQuery.execute at 0x7fc2f4d8a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │    └ <function Insert._execute at 0x7fc2f4d8fb00>
           └ <peewee.ModelInsert object at 0x7fc2f5e59a50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
                 │       └ <peewee.ModelInsert object at 0x7fc2f5e59a50>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fc2f5e59a50>
             │        └ <function Database.execute at 0x7fc2f4d92700>
             └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fc2f6928d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fc2f4d92660>
           └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fc2f4d94370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fc2f4437c40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fc2f51fe840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fc2f4437c40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f4422bc0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T20:57:47.783032+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (11855), thread 'WorkerThread2' (140475226912448):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686319067.779831, 'highprice', 'Берлин, Германия', datetime.date(2023, 6, 11), datetime.date(2023, 6, 20), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f41aa740>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fc2f5edf240>
    └ <WorkerThread(WorkerThread2, started daemon 140475226912448)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fc2f5d98720>
    └ <WorkerThread(WorkerThread2, started daemon 140475226912448)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fc2f43c1a80>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fc2f41bf0d0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fc2f5e33450>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fc2f41bf0d0>
             └ {'function': <function date_reply at 0x7fc2f43fede0>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fc2f41a1ad0>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fc2f41bf0d0>
    │                     │    │        └ {'last_command': 'highprice', 'cities': {'Берлин, Германия': '536', 'Berlin, Seedorf, Schleswig-Holstein, Germany': '55324863...
    │                     │    └ <telebot.types.Message object at 0x7fc2f41bf310>
    │                     └ <telebot.types.CallbackQuery object at 0x7fc2f41bf0d0>
    └ <function low_high_price_answer at 0x7fc2f43c32e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'1172384': {'name': 'JW Marriott Hotel Berlin', 'price_per_night': 325.98, 'total_price': '$3,286 total', 'distance_city_cen...
    │                 │                     └ {'last_command': 'highprice', 'cities': {'Берлин, Германия': '536', 'Berlin, Seedorf, Schleswig-Holstein, Germany': '55324863...
    │                 └ <telebot.types.Message object at 0x7fc2f41bf310>
    └ <function show_info at 0x7fc2f43c3ec0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686319067.779831, 'command': 'highprice', 'city': 'Берлин, Германия', 'start_date': datetime.date(2023, 6, 11), 'en...
         │    └ <classmethod(<function Model.insert at 0x7fc2f4db7740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │      └ <peewee.ModelInsert object at 0x7fc2f421ee90>
           └ <function BaseQuery.execute at 0x7fc2f4d8a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │    └ <function Insert._execute at 0x7fc2f4d8fb00>
           └ <peewee.ModelInsert object at 0x7fc2f421ee90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
                 │       └ <peewee.ModelInsert object at 0x7fc2f421ee90>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fc2f421ee90>
             │        └ <function Database.execute at 0x7fc2f4d92700>
             └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fc2f6928d10>
           │    │           │    └ [1686319067.779831, 'highprice', 'Берлин, Германия', datetime.date(2023, 6, 11), datetime.date(2023, 6, 20), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fc2f4d92660>
           └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fc2f4d94370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fc2f421c080>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fc2f51fe840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fc2f421c080>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686319067.779831, 'highprice', 'Берлин, Германия', datetime.date(2023, 6, 11), datetime.date(2023, 6, 20), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f41aa740>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-09T21:01:51.294862+0700, ERROR, An error has been caught in function 'low_high_price_answer', process 'MainProcess' (11855), thread 'WorkerThread1' (140475307112128):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fc2f5edf240>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fc2f5d98720>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fc2f43c1a80>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fc2f41af410>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fc2f5e33450>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fc2f41af410>
             └ {'function': <function date_reply at 0x7fc2f43fede0>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

  File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fc2f42d67d0>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fc2f41af410>
    │                     │    │        └ {'last_command': 'highprice', 'cities': {'Вена, Австрия': '3704'}, 'city_id': '3704', 'city': 'Вена, Австрия', 'amount_hotels...
    │                     │    └ <telebot.types.Message object at 0x7fc2f41ac7d0>
    │                     └ <telebot.types.CallbackQuery object at 0x7fc2f41af410>
    └ <function low_high_price_answer at 0x7fc2f43c32e0>

> File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 36, in low_high_price_answer
    result_dict = process_hotels_info(hotels, amount_nights)
                  │                   │       └ 9
                  │                   └ {'Le Méridien Wien': ['922305', 1.15, 197.95, 'https://a.travel-assets.com/media/meso_cm/PAPI/Images/hotels/1000000/930000/92...
                  └ <function process_hotels_info at 0x7fc2f43a9da0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_hotels.py", line 125, in process_hotels_info
    hotel_neighbourhood = get_hotel_address(value[0])
                          │                 └ ['922305', 1.15, 197.95, 'https://a.travel-assets.com/media/meso_cm/PAPI/Images/hotels/1000000/930000/922400/922305/61fa4df2_...
                          └ <function get_hotel_address at 0x7fc2f43a9a80>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/misc/get_address.py", line 17, in get_hotel_address
    data = json.loads(response.text)
           │    │     └ None
           │    └ <function loads at 0x7fc2f5df98a0>
           └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-09T21:03:49.182986+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (11855), thread 'WorkerThread1' (140475307112128):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686319429.182338, 'lowprice', 'Вена, Австрия', datetime.date(2023, 11, 16), datetime.date(2023, 11, 30), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f41b4ac0>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fc2f5edf240>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fc2f5d98720>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fc2f43c1a80>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fc2f4211650>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fc2f5e33450>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fc2f4211650>
             └ {'function': <function date_reply at 0x7fc2f43fede0>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fc2f42cad10>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fc2f4211650>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'Вена, Австрия': '3704'}, 'city_id': '3704', 'city': 'Вена, Австрия', 'amount_hotels'...
    │                     │    └ <telebot.types.Message object at 0x7fc2f4211710>
    │                     └ <telebot.types.CallbackQuery object at 0x7fc2f4211650>
    └ <function low_high_price_answer at 0x7fc2f43c32e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'2246188': {'name': 'a&o Wien Stadthalle', 'price_per_night': 15.88, 'total_price': '$250 total', 'distance_city_center': 2....
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'Вена, Австрия': '3704'}, 'city_id': '3704', 'city': 'Вена, Австрия', 'amount_hotels'...
    │                 └ <telebot.types.Message object at 0x7fc2f4211710>
    └ <function show_info at 0x7fc2f43c3ec0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686319429.182338, 'command': 'lowprice', 'city': 'Вена, Австрия', 'start_date': datetime.date(2023, 11, 16), 'end_d...
         │    └ <classmethod(<function Model.insert at 0x7fc2f4db7740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │      └ <peewee.ModelInsert object at 0x7fc2f4210910>
           └ <function BaseQuery.execute at 0x7fc2f4d8a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │    └ <function Insert._execute at 0x7fc2f4d8fb00>
           └ <peewee.ModelInsert object at 0x7fc2f4210910>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
                 │       └ <peewee.ModelInsert object at 0x7fc2f4210910>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fc2f4210910>
             │        └ <function Database.execute at 0x7fc2f4d92700>
             └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fc2f6928d10>
           │    │           │    └ [1686319429.182338, 'lowprice', 'Вена, Австрия', datetime.date(2023, 11, 16), datetime.date(2023, 11, 30), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fc2f4d92660>
           └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fc2f4d94370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fc2f42123c0>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fc2f51fe840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fc2f42123c0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686319429.182338, 'lowprice', 'Вена, Австрия', datetime.date(2023, 11, 16), datetime.date(2023, 11, 30), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f41b4ac0>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-09T21:06:15.862672+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (11855), thread 'WorkerThread1' (140475307112128):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686319575.86176, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f4402d40>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fc2f5edf240>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fc2f5d98720>
    └ <WorkerThread(WorkerThread1, started daemon 140475307112128)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fc2f43c1a80>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fc2f423c390>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fc2f5e33450>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fc2f423c390>
             └ {'function': <function date_reply at 0x7fc2f43fede0>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fc2f4212c10>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fc2f423c390>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'Нью-Йорк, Нью-Йорк, США': '2621', 'Бруклин, Нью-Йорк, США': '177851'}, 'city_id': '2...
    │                     │    └ <telebot.types.Message object at 0x7fc2f423fe50>
    │                     └ <telebot.types.CallbackQuery object at 0x7fc2f423c390>
    └ <function low_high_price_answer at 0x7fc2f43c32e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'5660562': {'name': 'Bowery Grand Hotel', 'price_per_night': 51.43, 'total_price': '$438 total', 'distance_city_center': 1.1...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'Нью-Йорк, Нью-Йорк, США': '2621', 'Бруклин, Нью-Йорк, США': '177851'}, 'city_id': '2...
    │                 └ <telebot.types.Message object at 0x7fc2f423fe50>
    └ <function show_info at 0x7fc2f43c3ec0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686319575.86176, 'command': 'lowprice', 'city': 'Нью-Йорк, Нью-Йорк, США', 'start_date': datetime.date(2023, 8, 15)...
         │    └ <classmethod(<function Model.insert at 0x7fc2f4db7740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │      └ <peewee.ModelInsert object at 0x7fc2f42d1110>
           └ <function BaseQuery.execute at 0x7fc2f4d8a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
           │    └ <function Insert._execute at 0x7fc2f4d8fb00>
           └ <peewee.ModelInsert object at 0x7fc2f42d1110>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
                 │       └ <peewee.ModelInsert object at 0x7fc2f42d1110>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fc2f42d1110>
             │        └ <function Database.execute at 0x7fc2f4d92700>
             └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fc2f6928d10>
           │    │           │    └ [1686319575.86176, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fc2f4d92660>
           └ <peewee.SqliteDatabase object at 0x7fc2f4d54c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fc2f4d94370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fc2f42cea80>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fc2f51fe840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fc2f42cea80>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686319575.86176, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fc2f4402d40>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-09T22:50:57.267497+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (14762), thread 'WorkerThread1' (139721247581888):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f13624e6fc0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f13647df240>
    └ <WorkerThread(WorkerThread1, started daemon 139721247581888)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f1364698720>
    └ <WorkerThread(WorkerThread1, started daemon 139721247581888)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f136360f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f1363fa1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f1363c25050>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f1363fa1750>
             └ {'function': <function bot_start at 0x7f13624d9a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f1363fa1750>
    └ <function save_user at 0x7f136247b560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f1363683740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f1363624c90>
           │      └ <peewee.ModelInsert object at 0x7f13625038d0>
           └ <function BaseQuery.execute at 0x7f1363656520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f1363624c90>
           │    └ <function Insert._execute at 0x7f136365bb00>
           └ <peewee.ModelInsert object at 0x7f13625038d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f1363624c90>
                 │       └ <peewee.ModelInsert object at 0x7f13625038d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f13625038d0>
             │        └ <function Database.execute at 0x7f136365e700>
             └ <peewee.SqliteDatabase object at 0x7f1363624c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f1364984d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f136365e660>
           └ <peewee.SqliteDatabase object at 0x7f1363624c90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f1363660370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f1362501d40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f1363aea840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f1362501d40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f13624e6fc0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T22:53:58.712641+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (14820), thread 'WorkerThread1' (140005184554688):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f557e44f240>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f55806e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140005184554688)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f558059c720>
    └ <WorkerThread(WorkerThread1, started daemon 140005184554688)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f557f577240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f557f58e250>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f557fa10ad0>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f557f58e250>
             └ {'function': <function bot_start at 0x7f557e43da80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f557f58e250>
    └ <function save_user at 0x7f557e3df560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f557f5eb740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f557f58cad0>
           │      └ <peewee.ModelInsert object at 0x7f557e46a8d0>
           └ <function BaseQuery.execute at 0x7f557f5be520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f557f58cad0>
           │    └ <function Insert._execute at 0x7f557f5c3b00>
           └ <peewee.ModelInsert object at 0x7f557e46a8d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f557f58cad0>
                 │       └ <peewee.ModelInsert object at 0x7f557e46a8d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f557e46a8d0>
             │        └ <function Database.execute at 0x7f557f5c6700>
             └ <peewee.SqliteDatabase object at 0x7f557f58cad0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f558116cd10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f557f5c6660>
           └ <peewee.SqliteDatabase object at 0x7f557f58cad0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f557f5c8370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f557e46b8c0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f557fa2e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f557e46b8c0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f557e44f240>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T22:57:50.989884+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (14931), thread 'WorkerThread2' (139929195161280):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f43cd71ef40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f43cf9df240>
    └ <WorkerThread(WorkerThread2, started daemon 139929195161280)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f43cf898720>
    └ <WorkerThread(WorkerThread2, started daemon 139929195161280)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f43ce84b240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f43cf1a1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f43ced10cd0>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f43cf1a1750>
             └ {'function': <function bot_start at 0x7f43cd711a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f43cf1a1750>
    └ <function save_user at 0x7f43cd6b3560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f43ce8c3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
           │      └ <peewee.ModelInsert object at 0x7f43cf1d8990>
           └ <function BaseQuery.execute at 0x7f43ce896520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
           │    └ <function Insert._execute at 0x7f43ce89bb00>
           └ <peewee.ModelInsert object at 0x7f43cf1d8990>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
                 │       └ <peewee.ModelInsert object at 0x7f43cf1d8990>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f43cf1d8990>
             │        └ <function Database.execute at 0x7f43ce89e700>
             └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f43cfb84d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f43ce89e660>
           └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f43ce8a0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f43cd737f00>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f43ced2a840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f43cd737f00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f43cd71ef40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T23:01:19.703018+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (14931), thread 'WorkerThread2' (139929195161280):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f43cccc49c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f43cf9df240>
    └ <WorkerThread(WorkerThread2, started daemon 139929195161280)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f43cf898720>
    └ <WorkerThread(WorkerThread2, started daemon 139929195161280)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f43ce84b240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f43cebe3b90>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f43ced10cd0>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f43cebe3b90>
             └ {'function': <function bot_start at 0x7f43cd711a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f43cebe3b90>
    └ <function save_user at 0x7f43cd6b3560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f43ce8c3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
           │      └ <peewee.ModelInsert object at 0x7f43cd7409d0>
           └ <function BaseQuery.execute at 0x7f43ce896520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
           │    └ <function Insert._execute at 0x7f43ce89bb00>
           └ <peewee.ModelInsert object at 0x7f43cd7409d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
                 │       └ <peewee.ModelInsert object at 0x7f43cd7409d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f43cd7409d0>
             │        └ <function Database.execute at 0x7f43ce89e700>
             └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f43cfb84d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f43ce89e660>
           └ <peewee.SqliteDatabase object at 0x7f43ce860d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f43ce8a0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f43cccc3bc0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f43ced2a840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f43cccc3bc0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f43cccc49c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T23:04:20.840145+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (15102), thread 'WorkerThread1' (140509211768512):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fcad8a12c40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fcadacdf240>
    └ <WorkerThread(WorkerThread1, started daemon 140509211768512)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fcadab98720>
    └ <WorkerThread(WorkerThread1, started daemon 140509211768512)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fcad9b3f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fcada289610>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fcadac18510>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fcada289610>
             └ {'function': <function bot_start at 0x7fcad8a05a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fcada289610>
    └ <function save_user at 0x7fcad89a7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fcad9bb7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fcad9b54b10>
           │      └ <peewee.ModelInsert object at 0x7fcada587890>
           └ <function BaseQuery.execute at 0x7fcad9b8a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fcad9b54b10>
           │    └ <function Insert._execute at 0x7fcad9b8fb00>
           └ <peewee.ModelInsert object at 0x7fcada587890>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fcad9b54b10>
                 │       └ <peewee.ModelInsert object at 0x7fcada587890>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fcada587890>
             │        └ <function Database.execute at 0x7fcad9b92700>
             └ <peewee.SqliteDatabase object at 0x7fcad9b54b10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fcadb734d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fcad9b92660>
           └ <peewee.SqliteDatabase object at 0x7fcad9b54b10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fcad9b94370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fcad8a2dd00>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fcad9ffe840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fcad8a2dd00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fcad8a12c40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T23:09:23.219723+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (15239), thread 'WorkerThread1' (140549166773952):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fd426222f40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd4284e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140549166773952)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fd42839c720>
    └ <WorkerThread(WorkerThread1, started daemon 140549166773952)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fd42734f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fd428582150>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fd427810ad0>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fd428582150>
             └ {'function': <function bot_start at 0x7fd426215a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fd428582150>
    └ <function save_user at 0x7fd4261b7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fd4273c7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fd427364c50>
           │      └ <peewee.ModelInsert object at 0x7fd42623ea50>
           └ <function BaseQuery.execute at 0x7fd42739a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fd427364c50>
           │    └ <function Insert._execute at 0x7fd42739fb00>
           └ <peewee.ModelInsert object at 0x7fd42623ea50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fd427364c50>
                 │       └ <peewee.ModelInsert object at 0x7fd42623ea50>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fd42623ea50>
             │        └ <function Database.execute at 0x7fd4273a2700>
             └ <peewee.SqliteDatabase object at 0x7fd427364c50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fd428f54d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fd4273a2660>
           └ <peewee.SqliteDatabase object at 0x7fd427364c50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fd4273a4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fd42623fb00>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fd42782e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fd42623fb00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fd426222f40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T23:18:37.456823+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (15466), thread 'WorkerThread1' (140563490039488):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fd77c5e7240>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd77e0e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140563490039488)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fd77df9c720>
    └ <WorkerThread(WorkerThread1, started daemon 140563490039488)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fd77cf0f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fd77c5fdb90>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fd77d3b0d10>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fd77c5fdb90>
             └ {'function': <function bot_start at 0x7fd77c5d9a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fd77c5fdb90>
    └ <function save_user at 0x7fd77c57b560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fd77cf83740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fd77cf24d50>
           │      └ <peewee.ModelInsert object at 0x7fd77e182050>
           └ <function BaseQuery.execute at 0x7fd77cf56520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fd77cf24d50>
           │    └ <function Insert._execute at 0x7fd77cf5bb00>
           └ <peewee.ModelInsert object at 0x7fd77e182050>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fd77cf24d50>
                 │       └ <peewee.ModelInsert object at 0x7fd77e182050>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fd77e182050>
             │        └ <function Database.execute at 0x7fd77cf5e700>
             └ <peewee.SqliteDatabase object at 0x7fd77cf24d50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fd77eb00d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fd77cf5e660>
           └ <peewee.SqliteDatabase object at 0x7fd77cf24d50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fd77cf60370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fd77c5fff00>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fd77d3ca840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fd77c5fff00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fd77c5e7240>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-09T23:20:15.801246+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (15544), thread 'WorkerThread2' (139897542780608):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f3c6ed12f40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3c70fdf240>
    └ <WorkerThread(WorkerThread2, started daemon 139897542780608)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f3c70e98720>
    └ <WorkerThread(WorkerThread2, started daemon 139897542780608)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f3c6fe3f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f3c70589610>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f3c70f18510>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f3c70589610>
             └ {'function': <function bot_start at 0x7f3c6ed05a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f3c70589610>
    └ <function save_user at 0x7f3c6eca7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f3c6feb7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f3c6fe54b10>
           │      └ <peewee.ModelInsert object at 0x7f3c70d87890>
           └ <function BaseQuery.execute at 0x7f3c6fe8a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f3c6fe54b10>
           │    └ <function Insert._execute at 0x7f3c6fe8fb00>
           └ <peewee.ModelInsert object at 0x7f3c70d87890>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f3c6fe54b10>
                 │       └ <peewee.ModelInsert object at 0x7f3c70d87890>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f3c70d87890>
             │        └ <function Database.execute at 0x7f3c6fe92700>
             └ <peewee.SqliteDatabase object at 0x7f3c6fe54b10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f3c71184d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f3c6fe92660>
           └ <peewee.SqliteDatabase object at 0x7f3c6fe54b10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f3c6fe94370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f3c6ed2f6c0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f3c702fe840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f3c6ed2f6c0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f3c6ed12f40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T00:28:33.559940+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (17672), thread 'WorkerThread2' (140640167573184):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fe956b4ebc0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fe958ddf240>
    └ <WorkerThread(WorkerThread2, started daemon 140640167573184)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fe958c98720>
    └ <WorkerThread(WorkerThread2, started daemon 140640167573184)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fe957c73240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fe9585a1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fe958bda310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fe9585a1750>
             └ {'function': <function bot_start at 0x7fe956b39b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fe9585a1750>
    └ <function save_user at 0x7fe956adb560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fe957ce7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fe957c88e10>
           │      └ <peewee.ModelInsert object at 0x7fe956b69610>
           └ <function BaseQuery.execute at 0x7fe957cba520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fe957c88e10>
           │    └ <function Insert._execute at 0x7fe957cbfb00>
           └ <peewee.ModelInsert object at 0x7fe956b69610>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fe957c88e10>
                 │       └ <peewee.ModelInsert object at 0x7fe956b69610>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fe956b69610>
             │        └ <function Database.execute at 0x7fe957cc2700>
             └ <peewee.SqliteDatabase object at 0x7fe957c88e10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fe958f84d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fe957cc2660>
           └ <peewee.SqliteDatabase object at 0x7fe957c88e10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fe957cc4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fe956b69800>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fe95812a840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fe956b69800>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fe956b4ebc0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T00:31:01.132480+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (17755), thread 'WorkerThread1' (140668104480448):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fefd75ffc40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fefd98e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140668104480448)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fefd979c720>
    └ <WorkerThread(WorkerThread1, started daemon 140668104480448)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fefd872b240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fefd7619510>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fefd90dc790>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fefd7619510>
             └ {'function': <function bot_start at 0x7fefd75f1b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fefd7619510>
    └ <function save_user at 0x7fefd7593560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fefd879f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fefd8740cd0>
           │      └ <peewee.ModelInsert object at 0x7fefd7618d10>
           └ <function BaseQuery.execute at 0x7fefd8772520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fefd8740cd0>
           │    └ <function Insert._execute at 0x7fefd8777b00>
           └ <peewee.ModelInsert object at 0x7fefd7618d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fefd8740cd0>
                 │       └ <peewee.ModelInsert object at 0x7fefd7618d10>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fefd7618d10>
             │        └ <function Database.execute at 0x7fefd877a700>
             └ <peewee.SqliteDatabase object at 0x7fefd8740cd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fefda328d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fefd877a660>
           └ <peewee.SqliteDatabase object at 0x7fefd8740cd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fefd877c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fefd761a400>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fefd8c06840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fefd761a400>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fefd75ffc40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T00:35:10.066023+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (17845), thread 'WorkerThread1' (140596335085248):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686332110.064347, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fdf20fb9c40>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fdf23bdf240>
    └ <WorkerThread(WorkerThread1, started daemon 140596335085248)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fdf23a98720>
    └ <WorkerThread(WorkerThread1, started daemon 140596335085248)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fdf218fd8a0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fdf2199b9d0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fdf22efae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fdf2199b9d0>
             └ {'function': <function date_reply at 0x7fdf21946f20>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fdf22a9ce90>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fdf2199b9d0>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'Нью-Йорк, Нью-Йорк, США': '2621', 'Бруклин, Нью-Йорк, США': '177851'}, 'city_id': '2...
    │                     │    └ <telebot.types.Message object at 0x7fdf2199bd50>
    │                     └ <telebot.types.CallbackQuery object at 0x7fdf2199b9d0>
    └ <function low_high_price_answer at 0x7fdf218ff100>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'5660562': {'name': 'Bowery Grand Hotel', 'price_per_night': 51.43, 'total_price': '$438 total', 'distance_city_center': 1.1...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'Нью-Йорк, Нью-Йорк, США': '2621', 'Бруклин, Нью-Йорк, США': '177851'}, 'city_id': '2...
    │                 └ <telebot.types.Message object at 0x7fdf2199bd50>
    └ <function show_info at 0x7fdf218ffce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686332110.064347, 'command': 'lowprice', 'city': 'Нью-Йорк, Нью-Йорк, США', 'start_date': datetime.date(2023, 8, 15...
         │    └ <classmethod(<function Model.insert at 0x7fdf22afb740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fdf22a9cf50>
           │      └ <peewee.ModelInsert object at 0x7fdf2197a510>
           └ <function BaseQuery.execute at 0x7fdf22ace520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fdf22a9cf50>
           │    └ <function Insert._execute at 0x7fdf22ad3b00>
           └ <peewee.ModelInsert object at 0x7fdf2197a510>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fdf22a9cf50>
                 │       └ <peewee.ModelInsert object at 0x7fdf2197a510>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fdf2197a510>
             │        └ <function Database.execute at 0x7fdf22ad6700>
             └ <peewee.SqliteDatabase object at 0x7fdf22a9cf50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fdf23d84d10>
           │    │           │    └ [1686332110.064347, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fdf22ad6660>
           └ <peewee.SqliteDatabase object at 0x7fdf22a9cf50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fdf22ad8370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fdf2197d180>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fdf22f3e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fdf2197d180>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686332110.064347, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fdf20fb9c40>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T11:54:20.699662+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (4657), thread 'WorkerThread2' (140662254278336):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fee7b2ceec0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fee7d5df240>
    └ <WorkerThread(WorkerThread2, started daemon 140662254278336)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fee7d498720>
    └ <WorkerThread(WorkerThread2, started daemon 140662254278336)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fee7c3f7240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fee7cda1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fee7d3da310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fee7cda1750>
             └ {'function': <function bot_start at 0x7fee7b2c1b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fee7cda1750>
    └ <function save_user at 0x7fee7b263560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fee7c46b740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
           │      └ <peewee.ModelInsert object at 0x7fee7b2ead10>
           └ <function BaseQuery.execute at 0x7fee7c43e520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
           │    └ <function Insert._execute at 0x7fee7c443b00>
           └ <peewee.ModelInsert object at 0x7fee7b2ead10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
                 │       └ <peewee.ModelInsert object at 0x7fee7b2ead10>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fee7b2ead10>
             │        └ <function Database.execute at 0x7fee7c446700>
             └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fee7d784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fee7c446660>
           └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fee7c448370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fee7b2ebc40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fee7c8b2840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fee7b2ebc40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fee7b2ceec0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T11:56:21.669716+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (4657), thread 'WorkerThread1' (140662262671040):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686372981.666665, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fee7a8bf440>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fee7d5df240>
    └ <WorkerThread(WorkerThread1, started daemon 140662262671040)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fee7d498720>
    └ <WorkerThread(WorkerThread1, started daemon 140662262671040)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fee7b2718a0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fee7a876150>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fee7d3da310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fee7a876150>
             └ {'function': <function date_reply at 0x7fee7b2baf20>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fee7c768e10>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fee7a876150>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'Нью-Йорк, Нью-Йорк, США': '2621', 'Бруклин, Нью-Йорк, США': '177851'}, 'city_id': '2...
    │                     │    └ <telebot.types.Message object at 0x7fee7a875f10>
    │                     └ <telebot.types.CallbackQuery object at 0x7fee7a876150>
    └ <function low_high_price_answer at 0x7fee7b273100>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'5660562': {'name': 'Bowery Grand Hotel', 'price_per_night': 51.43, 'total_price': '$438 total', 'distance_city_center': 1.1...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'Нью-Йорк, Нью-Йорк, США': '2621', 'Бруклин, Нью-Йорк, США': '177851'}, 'city_id': '2...
    │                 └ <telebot.types.Message object at 0x7fee7a875f10>
    └ <function show_info at 0x7fee7b273ce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686372981.666665, 'command': 'lowprice', 'city': 'Нью-Йорк, Нью-Йорк, США', 'start_date': datetime.date(2023, 8, 15...
         │    └ <classmethod(<function Model.insert at 0x7fee7c46b740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
           │      └ <peewee.ModelInsert object at 0x7fee7a855f90>
           └ <function BaseQuery.execute at 0x7fee7c43e520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
           │    └ <function Insert._execute at 0x7fee7c443b00>
           └ <peewee.ModelInsert object at 0x7fee7a855f90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
                 │       └ <peewee.ModelInsert object at 0x7fee7a855f90>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fee7a855f90>
             │        └ <function Database.execute at 0x7fee7c446700>
             └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fee7d784d10>
           │    │           │    └ [1686372981.666665, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fee7c446660>
           └ <peewee.SqliteDatabase object at 0x7fee7c40ccd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fee7c448370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fee7a854540>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fee7c8b2840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fee7a854540>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686372981.666665, 'lowprice', 'Нью-Йорк, Нью-Йорк, США', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fee7a8bf440>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T13:04:46.686608+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (5931), thread 'WorkerThread1' (139889689228992):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f3a9a35aec0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3a9c5df240>
    └ <WorkerThread(WorkerThread1, started daemon 139889689228992)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f3a9c498720>
    └ <WorkerThread(WorkerThread1, started daemon 139889689228992)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f3a9b47f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f3a9bda1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f3a9b8fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f3a9bda1750>
             └ {'function': <function bot_start at 0x7f3a9a345b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f3a9bda1750>
    └ <function save_user at 0x7f3a9a2e7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f3a9b4f7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f3a9b494e10>
           │      └ <peewee.ModelInsert object at 0x7f3a9a366950>
           └ <function BaseQuery.execute at 0x7f3a9b4ca520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f3a9b494e10>
           │    └ <function Insert._execute at 0x7f3a9b4cfb00>
           └ <peewee.ModelInsert object at 0x7f3a9a366950>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f3a9b494e10>
                 │       └ <peewee.ModelInsert object at 0x7f3a9a366950>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f3a9a366950>
             │        └ <function Database.execute at 0x7f3a9b4d2700>
             └ <peewee.SqliteDatabase object at 0x7f3a9b494e10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f3a9c784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f3a9b4d2660>
           └ <peewee.SqliteDatabase object at 0x7f3a9b494e10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f3a9b4d4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f3a9a367e40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f3a9b93e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f3a9a367e40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f3a9a35aec0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T13:05:22.723579+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (5931), thread 'WorkerThread2' (139889680836288):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3a9c5df240>
    └ <WorkerThread(WorkerThread2, started daemon 139889680836288)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f3a9c498720>
    └ <WorkerThread(WorkerThread2, started daemon 139889680836288)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f3a9b47f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f3a9a3671d0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f3a9b8fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f3a9a3671d0>
             └ {'function': <function get_city at 0x7f3a9a33d3a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'New York'
                  │                  └ <telebot.types.Message object at 0x7f3a9a3671d0>
                  └ <function parse_cities_group at 0x7f3a9a2e68e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 26, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7f3a9c4f98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:06:18.012440+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (5931), thread 'WorkerThread2' (139889680836288):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3a9c5df240>
    └ <WorkerThread(WorkerThread2, started daemon 139889680836288)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f3a9c498720>
    └ <WorkerThread(WorkerThread2, started daemon 139889680836288)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f3a9b47f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f3a9bbb4f50>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f3a9b8fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f3a9bbb4f50>
             └ {'function': <function get_city at 0x7f3a9a33d3a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'Vena'
                  │                  └ <telebot.types.Message object at 0x7f3a9bbb4f50>
                  └ <function parse_cities_group at 0x7f3a9a2e68e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 26, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7f3a9c4f98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:06:33.179370+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (5931), thread 'WorkerThread1' (139889689228992):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3a9c5df240>
    └ <WorkerThread(WorkerThread1, started daemon 139889689228992)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f3a9c498720>
    └ <WorkerThread(WorkerThread1, started daemon 139889689228992)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f3a9b47f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f3a9a366090>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f3a9b8fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f3a9a366090>
             └ {'function': <function get_city at 0x7f3a9a33d3a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'Москва'
                  │                  └ <telebot.types.Message object at 0x7f3a9a366090>
                  └ <function parse_cities_group at 0x7f3a9a2e68e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 26, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7f3a9c4f98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:12:54.659987+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (6083), thread 'WorkerThread2' (139621198747328):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7efc176e3440>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7efc199df240>
    └ <WorkerThread(WorkerThread2, started daemon 139621198747328)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7efc19898720>
    └ <WorkerThread(WorkerThread2, started daemon 139621198747328)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7efc1880b240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7efc176fe4d0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7efc197da310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7efc176fe4d0>
             └ {'function': <function bot_start at 0x7efc176d5a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7efc176fe4d0>
    └ <function save_user at 0x7efc17677560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7efc1887f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
           │      └ <peewee.ModelInsert object at 0x7efc18821d50>
           └ <function BaseQuery.execute at 0x7efc18852520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
           │    └ <function Insert._execute at 0x7efc18857b00>
           └ <peewee.ModelInsert object at 0x7efc18821d50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
                 │       └ <peewee.ModelInsert object at 0x7efc18821d50>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7efc18821d50>
             │        └ <function Database.execute at 0x7efc1885a700>
             └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7efc19b84d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7efc1885a660>
           └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7efc1885c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7efc176ffec0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7efc18cc6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7efc176ffec0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7efc176e3440>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T13:14:11.706773+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (6083), thread 'WorkerThread2' (139621198747328):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686377651.703655, 'lowprice', 'New York, New York, United States of America', datetime.date(2023, 8, 15), datetime.date(202...
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7efc16c8d440>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7efc199df240>
    └ <WorkerThread(WorkerThread2, started daemon 139621198747328)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7efc19898720>
    └ <WorkerThread(WorkerThread2, started daemon 139621198747328)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7efc176858a0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7efc16c77510>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7efc197da310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7efc16c77510>
             └ {'function': <function date_reply at 0x7efc176cee80>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7efc16d93d50>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7efc16c77510>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'New York, New York, United States of America': '2621'}, 'city_id': '2621', 'city': '...
    │                     │    └ <telebot.types.Message object at 0x7efc16c75410>
    │                     └ <telebot.types.CallbackQuery object at 0x7efc16c77510>
    └ <function low_high_price_answer at 0x7efc17687100>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'5660562': {'name': 'Bowery Grand Hotel', 'price_per_night': 51.43, 'total_price': '$438 total', 'distance_city_center': 1.1...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'New York, New York, United States of America': '2621'}, 'city_id': '2621', 'city': '...
    │                 └ <telebot.types.Message object at 0x7efc16c75410>
    └ <function show_info at 0x7efc17687ce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686377651.703655, 'command': 'lowprice', 'city': 'New York, New York, United States of America', 'start_date': date...
         │    └ <classmethod(<function Model.insert at 0x7efc1887f740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
           │      └ <peewee.ModelInsert object at 0x7efc16cd40d0>
           └ <function BaseQuery.execute at 0x7efc18852520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
           │    └ <function Insert._execute at 0x7efc18857b00>
           └ <peewee.ModelInsert object at 0x7efc16cd40d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
                 │       └ <peewee.ModelInsert object at 0x7efc16cd40d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7efc16cd40d0>
             │        └ <function Database.execute at 0x7efc1885a700>
             └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7efc19b84d10>
           │    │           │    └ [1686377651.703655, 'lowprice', 'New York, New York, United States of America', datetime.date(2023, 8, 15), datetime.date(202...
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7efc1885a660>
           └ <peewee.SqliteDatabase object at 0x7efc18820dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7efc1885c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7efc16cd4780>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7efc18cc6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7efc16cd4780>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686377651.703655, 'lowprice', 'New York, New York, United States of America', datetime.date(2023, 8, 15), datetime.date(202...
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7efc16c8d440>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T13:17:43.285737+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (6197), thread 'WorkerThread1' (140453703792320):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fbdec196ec0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fbdee4e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140453703792320)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fbdee39c720>
    └ <WorkerThread(WorkerThread1, started daemon 140453703792320)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fbded2c3240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fbdec1b6310>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fbded768e50>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fbdec1b6310>
             └ {'function': <function bot_start at 0x7fbdec189b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fbdec1b6310>
    └ <function save_user at 0x7fbdec12b6a0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fbded33b740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
           │      └ <peewee.ModelInsert object at 0x7fbded638cd0>
           └ <function BaseQuery.execute at 0x7fbded30e520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
           │    └ <function Insert._execute at 0x7fbded313b00>
           └ <peewee.ModelInsert object at 0x7fbded638cd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
                 │       └ <peewee.ModelInsert object at 0x7fbded638cd0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fbded638cd0>
             │        └ <function Database.execute at 0x7fbded316700>
             └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fbdeeeb0d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fbded316660>
           └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fbded318370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fbdec1b7700>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fbded782840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fbdec1b7700>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fbdec196ec0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T13:19:06.979771+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (6197), thread 'WorkerThread1' (140453703792320):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686377946.978617, 'lowprice', 'London, England, United Kingdom', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fbde76d3a40>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fbdee4e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140453703792320)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fbdee39c720>
    └ <WorkerThread(WorkerThread1, started daemon 140453703792320)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fbdec1399e0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fbde7665b10>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fbded768e50>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fbde7665b10>
             └ {'function': <function date_reply at 0x7fbdec182f20>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fbde760fe90>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fbde7665b10>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'London, England, United Kingdom': '2114', 'London, Kentucky, United States of Americ...
    │                     │    └ <telebot.types.Message object at 0x7fbde7665090>
    │                     └ <telebot.types.CallbackQuery object at 0x7fbde7665b10>
    └ <function low_high_price_answer at 0x7fbdec13b240>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'10003380': {'name': 'Publove @ Exmouth Arms Euston', 'price_per_night': 49.08, 'total_price': '$412 total', 'distance_city_...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'London, England, United Kingdom': '2114', 'London, Kentucky, United States of Americ...
    │                 └ <telebot.types.Message object at 0x7fbde7665090>
    └ <function show_info at 0x7fbdec13be20>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686377946.978617, 'command': 'lowprice', 'city': 'London, England, United Kingdom', 'start_date': datetime.date(202...
         │    └ <classmethod(<function Model.insert at 0x7fbded33b740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
           │      └ <peewee.ModelInsert object at 0x7fbde764b210>
           └ <function BaseQuery.execute at 0x7fbded30e520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
           │    └ <function Insert._execute at 0x7fbded313b00>
           └ <peewee.ModelInsert object at 0x7fbde764b210>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
                 │       └ <peewee.ModelInsert object at 0x7fbde764b210>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fbde764b210>
             │        └ <function Database.execute at 0x7fbded316700>
             └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fbdeeeb0d10>
           │    │           │    └ [1686377946.978617, 'lowprice', 'London, England, United Kingdom', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fbded316660>
           └ <peewee.SqliteDatabase object at 0x7fbded2d8d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fbded318370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fbde764adc0>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fbded782840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fbde764adc0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686377946.978617, 'lowprice', 'London, England, United Kingdom', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fbde76d3a40>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T13:41:23.701878+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (6558), thread 'WorkerThread1' (140425647310528):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb7644cecc0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fb765fdf240>
    └ <WorkerThread(WorkerThread1, started daemon 140425647310528)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fb765e98720>
    └ <WorkerThread(WorkerThread1, started daemon 140425647310528)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fb764dfb240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fb7657a1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fb765dda310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fb7657a1750>
             └ {'function': <function bot_start at 0x7fb7644c1b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fb7657a1750>
    └ <function save_user at 0x7fb764463560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fb764e7f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fb764e10d50>
           │      └ <peewee.ModelInsert object at 0x7fb7644ed650>
           └ <function BaseQuery.execute at 0x7fb764e52520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fb764e10d50>
           │    └ <function Insert._execute at 0x7fb764e57b00>
           └ <peewee.ModelInsert object at 0x7fb7644ed650>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fb764e10d50>
                 │       └ <peewee.ModelInsert object at 0x7fb7644ed650>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fb7644ed650>
             │        └ <function Database.execute at 0x7fb764e5a700>
             └ <peewee.SqliteDatabase object at 0x7fb764e10d50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fb766184d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fb764e5a660>
           └ <peewee.SqliteDatabase object at 0x7fb764e10d50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fb764e5c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fb7644ee2c0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fb7652c6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fb7644ee2c0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb7644cecc0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T13:42:03.201123+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (6558), thread 'WorkerThread1' (140425647310528):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fb765fdf240>
    └ <WorkerThread(WorkerThread1, started daemon 140425647310528)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fb765e98720>
    └ <WorkerThread(WorkerThread1, started daemon 140425647310528)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fb764dfb240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fb7644effd0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fb765dda310>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fb7644effd0>
             └ {'function': <function get_city at 0x7fb7644b93a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'Вена'
                  │                  └ <telebot.types.Message object at 0x7fb7644effd0>
                  └ <function parse_cities_group at 0x7fb7644628e0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 27, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7fb765ef98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:45:17.335562+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (6638), thread 'WorkerThread1' (140049827759808):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f5fe335f1c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f5fe55df240>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f5fe5498720>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f5fe4487240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f5fe4da1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f5fe48fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f5fe4da1750>
             └ {'function': <function bot_start at 0x7f5fe334db20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f5fe4da1750>
    └ <function save_user at 0x7f5fe32ef6a0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f5fe44fb740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f5fe449ce90>
           │      └ <peewee.ModelInsert object at 0x7f5fe55f6810>
           └ <function BaseQuery.execute at 0x7f5fe44ce520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f5fe449ce90>
           │    └ <function Insert._execute at 0x7f5fe44d3b00>
           └ <peewee.ModelInsert object at 0x7f5fe55f6810>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f5fe449ce90>
                 │       └ <peewee.ModelInsert object at 0x7f5fe55f6810>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f5fe55f6810>
             │        └ <function Database.execute at 0x7f5fe44d6700>
             └ <peewee.SqliteDatabase object at 0x7f5fe449ce90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f5fe5784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f5fe44d6660>
           └ <peewee.SqliteDatabase object at 0x7f5fe449ce90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f5fe44d8370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f5fe3375880>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f5fe493e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f5fe3375880>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f5fe335f1c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T13:45:42.787891+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (6638), thread 'WorkerThread1' (140049827759808):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f5fe55df240>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f5fe5498720>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f5fe4487240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f5fe3374f10>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f5fe48fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f5fe3374f10>
             └ {'function': <function get_city at 0x7f5fe33453a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'Лондон'
                  │                  └ <telebot.types.Message object at 0x7f5fe3374f10>
                  └ <function parse_cities_group at 0x7f5fe32eea20>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 26, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7f5fe54f98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:45:55.739615+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (6638), thread 'WorkerThread1' (140049827759808):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f5fe55df240>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f5fe5498720>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f5fe4487240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f5fe3376650>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f5fe48fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f5fe3376650>
             └ {'function': <function get_city at 0x7f5fe33453a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'Москва'
                  │                  └ <telebot.types.Message object at 0x7f5fe3376650>
                  └ <function parse_cities_group at 0x7f5fe32eea20>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 26, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7f5fe54f98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:46:13.415433+0700, ERROR, An error has been caught in function 'get_city', process 'MainProcess' (6638), thread 'WorkerThread1' (140049827759808):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f5fe55df240>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f5fe5498720>
    └ <WorkerThread(WorkerThread1, started daemon 140049827759808)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f5fe4487240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f5fe2a1a510>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f5fe48fae90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f5fe2a1a510>
             └ {'function': <function get_city at 0x7f5fe33453a0>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state': <teleb...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 37, in get_city
    cities_dict = parse_cities_group(message.text)
                  │                  │       └ 'New York'
                  │                  └ <telebot.types.Message object at 0x7f5fe2a1a510>
                  └ <function parse_cities_group at 0x7f5fe32eea20>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/get_cities.py", line 26, in parse_cities_group
    data_site = json.loads(response.text)
                │    │     └ None
                │    └ <function loads at 0x7f5fe54f98a0>
                └ <module 'json' from '/usr/lib/python3.11/json/__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
2023-06-10T13:47:51.967669+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (6697), thread 'WorkerThread1' (140065679156928):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f638ffa71c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f63963df240>
    └ <WorkerThread(WorkerThread1, started daemon 140065679156928)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f6396298720>
    └ <WorkerThread(WorkerThread1, started daemon 140065679156928)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f63951a3240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f639593b1d0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f6395664d90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f639593b1d0>
             └ {'function': <function bot_start at 0x7f638ff99b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f639593b1d0>
    └ <function save_user at 0x7f638ff3b560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f6395217740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
           │      └ <peewee.ModelInsert object at 0x7f6395535990>
           └ <function BaseQuery.execute at 0x7f63951ea520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
           │    └ <function Insert._execute at 0x7f63951efb00>
           └ <peewee.ModelInsert object at 0x7f6395535990>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
                 │       └ <peewee.ModelInsert object at 0x7f6395535990>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f6395535990>
             │        └ <function Database.execute at 0x7f63951f2700>
             └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f6396584d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f63951f2660>
           └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f63951f4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f638ffc7140>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f639567e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f638ffc7140>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f638ffa71c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T13:49:50.856164+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (6697), thread 'WorkerThread1' (140065679156928):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686379790.85456, 'lowprice', 'Вена, Хультсфред, Кальмар  (лен), Швеция', datetime.date(2023, 8, 15), datetime.date(2023, 8,...
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f638f5ced40>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f63963df240>
    └ <WorkerThread(WorkerThread1, started daemon 140065679156928)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f6396298720>
    └ <WorkerThread(WorkerThread1, started daemon 140065679156928)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7f638ff498a0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7f638f56e850>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f6395664d90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7f638f56e850>
             └ {'function': <function date_reply at 0x7f638ff92f20>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7f638f6704d0>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7f638f56e850>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'Вена, Хультсфред, Кальмар  (лен), Швеция': '3000014039', 'Минск, Беларусь': '2427', ...
    │                     │    └ <telebot.types.Message object at 0x7f638f56e5d0>
    │                     └ <telebot.types.CallbackQuery object at 0x7f638f56e850>
    └ <function low_high_price_answer at 0x7f638ff4b100>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'20058223': {'name': 'Hotell Dacke', 'price_per_night': 37.1, 'total_price': '$291 total', 'distance_city_center': 32.83, 'h...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'Вена, Хультсфред, Кальмар  (лен), Швеция': '3000014039', 'Минск, Беларусь': '2427', ...
    │                 └ <telebot.types.Message object at 0x7f638f56e5d0>
    └ <function show_info at 0x7f638ff4bce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686379790.85456, 'command': 'lowprice', 'city': 'Вена, Хультсфред, Кальмар  (лен), Швеция', 'start_date': datetime....
         │    └ <classmethod(<function Model.insert at 0x7f6395217740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
           │      └ <peewee.ModelInsert object at 0x7f638f59ea50>
           └ <function BaseQuery.execute at 0x7f63951ea520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
           │    └ <function Insert._execute at 0x7f63951efb00>
           └ <peewee.ModelInsert object at 0x7f638f59ea50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
                 │       └ <peewee.ModelInsert object at 0x7f638f59ea50>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f638f59ea50>
             │        └ <function Database.execute at 0x7f63951f2700>
             └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f6396584d10>
           │    │           │    └ [1686379790.85456, 'lowprice', 'Вена, Хультсфред, Кальмар  (лен), Швеция', datetime.date(2023, 8, 15), datetime.date(2023, 8,...
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7f63951f2660>
           └ <peewee.SqliteDatabase object at 0x7f63951b8dd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f63951f4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f638f59d180>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f639567e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f638f59d180>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686379790.85456, 'lowprice', 'Вена, Хультсфред, Кальмар  (лен), Швеция', datetime.date(2023, 8, 15), datetime.date(2023, 8,...
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f638f5ced40>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T14:19:17.955120+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7149), thread 'WorkerThread2' (139943209322176):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f4710c1b2c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f4712ee3240>
    └ <WorkerThread(WorkerThread2, started daemon 139943209322176)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f4712d9c720>
    └ <WorkerThread(WorkerThread2, started daemon 139943209322176)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f4711d47240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f4711d5e350>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f47126dc790>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f4711d5e350>
             └ {'function': <function bot_start at 0x7f4710c11a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f4711d5e350>
    └ <function save_user at 0x7f4710baf600>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f4711dcf740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f4711d5cbd0>
           │      └ <peewee.ModelInsert object at 0x7f4710c37ad0>
           └ <function BaseQuery.execute at 0x7f4711da2520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f4711d5cbd0>
           │    └ <function Insert._execute at 0x7f4711da7b00>
           └ <peewee.ModelInsert object at 0x7f4710c37ad0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f4711d5cbd0>
                 │       └ <peewee.ModelInsert object at 0x7f4710c37ad0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f4710c37ad0>
             │        └ <function Database.execute at 0x7f4711daa700>
             └ <peewee.SqliteDatabase object at 0x7f4711d5cbd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f4713948d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f4711daa660>
           └ <peewee.SqliteDatabase object at 0x7f4711d5cbd0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f4711dac370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f4710c35e40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f4712216840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f4710c35e40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f4710c1b2c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T14:23:14.937792+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7257), thread 'WorkerThread1' (140591463237312):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddff3338c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fde013da290>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fde013da290>
             └ {'function': <function bot_start at 0x7fddff325b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fde013da290>
    └ <function save_user at 0x7fddff2c7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fde0044b850>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fde0044b850>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fde0044b850>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fde0044b850>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddff3584c0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddff3584c0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddff3338c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T14:23:14.943962+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7257), thread 'WorkerThread2' (140591454844608):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddff332040>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread2, started daemon 140591454844608)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread2, started daemon 140591454844608)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fddff351610>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fddff351610>
             └ {'function': <function bot_start at 0x7fddff325b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fddff351610>
    └ <function save_user at 0x7fddff2c7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddff351b10>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddff351b10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddff351b10>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddff351b10>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddfe97da40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddfe97da40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddff332040>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T14:23:38.179844+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7257), thread 'WorkerThread1' (140591463237312):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe887840>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fddff358c50>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fddff358c50>
             └ {'function': <function bot_start at 0x7fddff325b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fddff358c50>
    └ <function save_user at 0x7fddff2c7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddff3528d0>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddff3528d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddff3528d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddff3528d0>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddfe9f35c0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddfe9f35c0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe887840>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T14:24:54.313779+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (7257), thread 'WorkerThread1' (140591463237312):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686381894.312844, 'lowprice', 'Берлин, Германия', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bfbc0>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7fddff2d58a0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7fddff36a690>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7fddff36a690>
             └ {'function': <function date_reply at 0x7fddff31ef20>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7fddff351750>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7fddff36a690>
    │                     │    │        └ {'last_command': 'lowprice', 'cities': {'Берлин, Германия': '536', 'Berlin, Seedorf, Schleswig-Holstein, Germany': '553248635...
    │                     │    └ <telebot.types.Message object at 0x7fddff36a3d0>
    │                     └ <telebot.types.CallbackQuery object at 0x7fddff36a690>
    └ <function low_high_price_answer at 0x7fddff2d7100>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'53204806': {'name': 'NEOHOSTEL Berlin', 'price_per_night': 22.6, 'total_price': '$177 total', 'distance_city_center': 17.44...
    │                 │                     └ {'last_command': 'lowprice', 'cities': {'Берлин, Германия': '536', 'Berlin, Seedorf, Schleswig-Holstein, Germany': '553248635...
    │                 └ <telebot.types.Message object at 0x7fddff36a3d0>
    └ <function show_info at 0x7fddff2d7ce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686381894.312844, 'command': 'lowprice', 'city': 'Берлин, Германия', 'start_date': datetime.date(2023, 8, 15), 'end...
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddfe8fb410>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddfe8fb410>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddfe8fb410>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddfe8fb410>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [1686381894.312844, 'lowprice', 'Берлин, Германия', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddfe9fd540>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddfe9fd540>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686381894.312844, 'lowprice', 'Берлин, Германия', datetime.date(2023, 8, 15), datetime.date(2023, 8, 22), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bfbc0>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T14:25:11.238135+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7257), thread 'WorkerThread2' (140591454844608):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bfdc0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread2, started daemon 140591454844608)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread2, started daemon 140591454844608)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fddfe8fbdd0>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fddfe8fbdd0>
             └ {'function': <function bot_start at 0x7fddff325b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fddfe8fbdd0>
    └ <function save_user at 0x7fddff2c7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddfe940f10>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddfe940f10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddfe940f10>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddfe940f10>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddfe940b00>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddfe940b00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bfdc0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T14:27:28.938110+0700, ERROR, An error has been caught in function 'get_end_distance', process 'MainProcess' (7257), thread 'WorkerThread1' (140591463237312):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686382048.935184, 'bestdeal', 'Лондон, Англия, Великобритания', datetime.date(2023, 8, 8), datetime.date(2023, 8, 15), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bf5c0>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fddfe97e890>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fddfe97e890>
             └ {'function': <function get_end_distance at 0x7fddff324220>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state'...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 296, in get_end_distance
    best_deal_answer(message, data_dict, message.from_user.username)
    │                │        │          │       │         └ None
    │                │        │          │       └ <telebot.types.User object at 0x7fddfe97ef90>
    │                │        │          └ <telebot.types.Message object at 0x7fddfe97e890>
    │                │        └ {'last_command': 'bestdeal', 'cities': {'Лондон, Англия, Великобритания': '2114'}, 'city_id': '2114', 'city': 'Лондон, Англия...
    │                └ <telebot.types.Message object at 0x7fddfe97e890>
    └ <function best_deal_answer at 0x7fddff2d7880>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 105, in best_deal_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'42297074': {'name': 'Zedwell Piccadilly Circus', 'price_per_night': 133.11, 'total_price': '$1,118 total', 'distance_city_c...
    │                 │                     └ {'last_command': 'bestdeal', 'cities': {'Лондон, Англия, Великобритания': '2114'}, 'city_id': '2114', 'city': 'Лондон, Англия...
    │                 └ <telebot.types.Message object at 0x7fddfe97e890>
    └ <function show_info at 0x7fddff2d7ce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686382048.935184, 'command': 'bestdeal', 'city': 'Лондон, Англия, Великобритания', 'start_date': datetime.date(2023...
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddfe9faf90>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddfe9faf90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddfe9faf90>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddfe9faf90>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [1686382048.935184, 'bestdeal', 'Лондон, Англия, Великобритания', datetime.date(2023, 8, 8), datetime.date(2023, 8, 15), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddfe9f9f00>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddfe9f9f00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686382048.935184, 'bestdeal', 'Лондон, Англия, Великобритания', datetime.date(2023, 8, 8), datetime.date(2023, 8, 15), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bf5c0>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T14:29:08.522680+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7257), thread 'WorkerThread1' (140591463237312):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bf8c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread1, started daemon 140591463237312)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fddfe9f9f50>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fddfe9f9f50>
             └ {'function': <function bot_start at 0x7fddff325b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fddfe9f9f50>
    └ <function save_user at 0x7fddff2c7560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddfe9fd650>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddfe9fd650>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddfe9fd650>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddfe9fd650>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddfe94a840>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddfe94a840>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddfe9bf8c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T14:31:43.578699+0700, ERROR, An error has been caught in function 'get_end_distance', process 'MainProcess' (7257), thread 'WorkerThread2' (140591454844608):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686382303.577511, 'bestdeal', 'Вена, Хультсфред, Кальмар  (лен), Швеция', datetime.date(2023, 12, 11), datetime.date(2023, ...
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddff3235c0>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fde015df240>
    └ <WorkerThread(WorkerThread2, started daemon 140591454844608)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fde01498720>
    └ <WorkerThread(WorkerThread2, started daemon 140591454844608)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fde0045f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fddff351750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fde008d2e90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fddff351750>
             └ {'function': <function get_end_distance at 0x7fddff324220>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'state'...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 296, in get_end_distance
    best_deal_answer(message, data_dict, message.from_user.username)
    │                │        │          │       │         └ None
    │                │        │          │       └ <telebot.types.User object at 0x7fde01559d50>
    │                │        │          └ <telebot.types.Message object at 0x7fddff351750>
    │                │        └ {'last_command': 'bestdeal', 'cities': {'Вена, Хультсфред, Кальмар  (лен), Швеция': '3000014039', 'Минск, Беларусь': '2427', ...
    │                └ <telebot.types.Message object at 0x7fddff351750>
    └ <function best_deal_answer at 0x7fddff2d7880>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 105, in best_deal_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'30611561': {'name': 'Palace Hotell', 'price_per_night': 89.64, 'total_price': '$703 total', 'distance_city_center': 10.02, ...
    │                 │                     └ {'last_command': 'bestdeal', 'cities': {'Вена, Хультсфред, Кальмар  (лен), Швеция': '3000014039', 'Минск, Беларусь': '2427', ...
    │                 └ <telebot.types.Message object at 0x7fddff351750>
    └ <function show_info at 0x7fddff2d7ce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686382303.577511, 'command': 'bestdeal', 'city': 'Вена, Хультсфред, Кальмар  (лен), Швеция', 'start_date': datetime...
         │    └ <classmethod(<function Model.insert at 0x7fde004d3740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │      └ <peewee.ModelInsert object at 0x7fddff36b790>
           └ <function BaseQuery.execute at 0x7fde004a6520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fde00474d10>
           │    └ <function Insert._execute at 0x7fde004abb00>
           └ <peewee.ModelInsert object at 0x7fddff36b790>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fde00474d10>
                 │       └ <peewee.ModelInsert object at 0x7fddff36b790>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fddff36b790>
             │        └ <function Database.execute at 0x7fde004ae700>
             └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fde01784d10>
           │    │           │    └ [1686382303.577511, 'bestdeal', 'Вена, Хультсфред, Кальмар  (лен), Швеция', datetime.date(2023, 12, 11), datetime.date(2023, ...
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7fde004ae660>
           └ <peewee.SqliteDatabase object at 0x7fde00474d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fde004b0370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fddff36b840>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fde00916840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fddff36b840>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686382303.577511, 'bestdeal', 'Вена, Хультсфред, Кальмар  (лен), Швеция', datetime.date(2023, 12, 11), datetime.date(2023, ...
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fddff3235c0>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-06-10T14:49:04.508343+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (7699), thread 'WorkerThread1' (140192132024000):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f810534f140>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f81075df240>
    └ <WorkerThread(WorkerThread1, started daemon 140192132024000)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f8107498720>
    └ <WorkerThread(WorkerThread1, started daemon 140192132024000)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f8106473240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f8106da1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f8107518510>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f8106da1750>
             └ {'function': <function bot_start at 0x7f8105339b20>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f8106da1750>
    └ <function save_user at 0x7f81052db560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f81064e7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f8106488d90>
           │      └ <peewee.ModelInsert object at 0x7f81053631d0>
           └ <function BaseQuery.execute at 0x7f81064ba520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f8106488d90>
           │    └ <function Insert._execute at 0x7f81064bfb00>
           └ <peewee.ModelInsert object at 0x7f81053631d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f8106488d90>
                 │       └ <peewee.ModelInsert object at 0x7f81053631d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f81053631d0>
             │        └ <function Database.execute at 0x7f81064c2700>
             └ <peewee.SqliteDatabase object at 0x7f8106488d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f8107784d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f81064c2660>
           └ <peewee.SqliteDatabase object at 0x7f8106488d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f81064c4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f8105363f80>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f810692a840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f8105363f80>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f810534f140>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T15:28:22.567189+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (8353), thread 'WorkerThread2' (140061561575104):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f629f1ab1c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f62a14e3240>
    └ <WorkerThread(WorkerThread2, started daemon 140061561575104)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f62a139c720>
    └ <WorkerThread(WorkerThread2, started daemon 140061561575104)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f62a02d3240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f629f1c9690>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f62a0a4f1d0>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f629f1c9690>
             └ {'function': <function bot_start at 0x7f629f19da80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f629f1c9690>
    └ <function save_user at 0x7f629f13f560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f62a0347740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f62a02e8e10>
           │      └ <peewee.ModelInsert object at 0x7f62a063de10>
           └ <function BaseQuery.execute at 0x7f62a031a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f62a02e8e10>
           │    └ <function Insert._execute at 0x7f62a031fb00>
           └ <peewee.ModelInsert object at 0x7f62a063de10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f62a02e8e10>
                 │       └ <peewee.ModelInsert object at 0x7f62a063de10>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f62a063de10>
             │        └ <function Database.execute at 0x7f62a0322700>
             └ <peewee.SqliteDatabase object at 0x7f62a02e8e10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f62a1ed0d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f62a0322660>
           └ <peewee.SqliteDatabase object at 0x7f62a02e8e10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f62a0324370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f629f1cbcc0>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f62a07ae840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f629f1cbcc0>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f629f1ab1c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T15:36:41.879911+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (8473), thread 'WorkerThread1' (140417529607872):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb580726f40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fb5821df240>
    └ <WorkerThread(WorkerThread1, started daemon 140417529607872)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fb582098720>
    └ <WorkerThread(WorkerThread1, started daemon 140417529607872)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fb581053240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fb580742450>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fb5820f3690>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fb580742450>
             └ {'function': <function bot_start at 0x7fb580719a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fb580742450>
    └ <function save_user at 0x7fb5806bb560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fb5810cb740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fb581068e50>
           │      └ <peewee.ModelInsert object at 0x7fb581fbc090>
           └ <function BaseQuery.execute at 0x7fb58109e520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fb581068e50>
           │    └ <function Insert._execute at 0x7fb5810a3b00>
           └ <peewee.ModelInsert object at 0x7fb581fbc090>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fb581068e50>
                 │       └ <peewee.ModelInsert object at 0x7fb581fbc090>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fb581fbc090>
             │        └ <function Database.execute at 0x7fb5810a6700>
             └ <peewee.SqliteDatabase object at 0x7fb581068e50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fb582384d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fb5810a6660>
           └ <peewee.SqliteDatabase object at 0x7fb581068e50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fb5810a8370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fb580743e40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fb581512840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fb580743e40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb580726f40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T15:42:30.091263+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (8548), thread 'WorkerThread2' (139776269113024):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f203258ef40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f20348df240>
    └ <WorkerThread(WorkerThread2, started daemon 139776269113024)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f2034798720>
    └ <WorkerThread(WorkerThread2, started daemon 139776269113024)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f20336b7240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f2033a49750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f2033b78b90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f2033a49750>
             └ {'function': <function bot_start at 0x7f2032581a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f2033a49750>
    └ <function save_user at 0x7f2032523560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f203372b740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f20336ccb90>
           │      └ <peewee.ModelInsert object at 0x7f20325abad0>
           └ <function BaseQuery.execute at 0x7f20336fe520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f20336ccb90>
           │    └ <function Insert._execute at 0x7f2033703b00>
           └ <peewee.ModelInsert object at 0x7f20325abad0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f20336ccb90>
                 │       └ <peewee.ModelInsert object at 0x7f20325abad0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f20325abad0>
             │        └ <function Database.execute at 0x7f2033706700>
             └ <peewee.SqliteDatabase object at 0x7f20336ccb90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f20352b0d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f2033706660>
           └ <peewee.SqliteDatabase object at 0x7f20336ccb90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f2033708370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f20348ebc00>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f2033b92840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f20348ebc00>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f203258ef40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:09:43.322026+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (8938), thread 'WorkerThread1' (140553951143616):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fd5434e2f40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5457df240>
    └ <WorkerThread(WorkerThread1, started daemon 140553951143616)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fd545698720>
    └ <WorkerThread(WorkerThread1, started daemon 140553951143616)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fd54460b240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fd544fa1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fd544aacc90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fd544fa1750>
             └ {'function': <function bot_start at 0x7fd5434d5a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fd544fa1750>
    └ <function save_user at 0x7fd543477560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fd54467f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fd544620d90>
           │      └ <peewee.ModelInsert object at 0x7fd54497d7d0>
           └ <function BaseQuery.execute at 0x7fd544652520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fd544620d90>
           │    └ <function Insert._execute at 0x7fd544657b00>
           └ <peewee.ModelInsert object at 0x7fd54497d7d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fd544620d90>
                 │       └ <peewee.ModelInsert object at 0x7fd54497d7d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fd54497d7d0>
             │        └ <function Database.execute at 0x7fd54465a700>
             └ <peewee.SqliteDatabase object at 0x7fd544620d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fd545984d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fd54465a660>
           └ <peewee.SqliteDatabase object at 0x7fd544620d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fd54465c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fd543503d40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fd544ac6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fd543503d40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fd5434e2f40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:11:05.777230+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (8982), thread 'WorkerThread1' (140607377475264):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fe1b4436f40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fe1b5ee3240>
    └ <WorkerThread(WorkerThread1, started daemon 140607377475264)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fe1b5d9c720>
    └ <WorkerThread(WorkerThread1, started daemon 140607377475264)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fe1b4d63240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fe1b4d4fc90>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fe1b5200d90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fe1b4d4fc90>
             └ {'function': <function bot_start at 0x7fe1b4429a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fe1b4d4fc90>
    └ <function save_user at 0x7fe1b43cb560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fe1b4dd7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fe1b4d79010>
           │      └ <peewee.ModelInsert object at 0x7fe1b5701210>
           └ <function BaseQuery.execute at 0x7fe1b4daa520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fe1b4d79010>
           │    └ <function Insert._execute at 0x7fe1b4dafb00>
           └ <peewee.ModelInsert object at 0x7fe1b5701210>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fe1b4d79010>
                 │       └ <peewee.ModelInsert object at 0x7fe1b5701210>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fe1b5701210>
             │        └ <function Database.execute at 0x7fe1b4db2700>
             └ <peewee.SqliteDatabase object at 0x7fe1b4d79010>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fe1b6950d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fe1b4db2660>
           └ <peewee.SqliteDatabase object at 0x7fe1b4d79010>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fe1b4db4370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fe1b439df40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fe1b521a840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fe1b439df40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fe1b4436f40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:31:50.924646+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (9262), thread 'WorkerThread1' (139766658397888):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f1df500aec0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f1df72e3240>
    └ <WorkerThread(WorkerThread1, started daemon 139766658397888)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f1df719c720>
    └ <WorkerThread(WorkerThread1, started daemon 139766658397888)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f1df612f240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f1df501d990>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f1df65d4c10>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f1df501d990>
             └ {'function': <function bot_start at 0x7f1df4ff5a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 18, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f1df501d990>
    └ <function save_user at 0x7f1df4f97560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f1df61a7740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f1df6144a10>
           │      └ <peewee.ModelInsert object at 0x7f1df501fc10>
           └ <function BaseQuery.execute at 0x7f1df617a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f1df6144a10>
           │    └ <function Insert._execute at 0x7f1df617fb00>
           └ <peewee.ModelInsert object at 0x7f1df501fc10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f1df6144a10>
                 │       └ <peewee.ModelInsert object at 0x7f1df501fc10>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f1df501fc10>
             │        └ <function Database.execute at 0x7f1df6182700>
             └ <peewee.SqliteDatabase object at 0x7f1df6144a10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f1df7d20d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f1df6182660>
           └ <peewee.SqliteDatabase object at 0x7f1df6144a10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f1df6184370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f1df6877140>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f1df65ee840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f1df6877140>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f1df500aec0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:37:40.834666+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (9390), thread 'WorkerThread1' (140388320175808):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7faeb2ee2f40>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7faeb51df240>
    └ <WorkerThread(WorkerThread1, started daemon 140388320175808)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7faeb5098720>
    └ <WorkerThread(WorkerThread1, started daemon 140388320175808)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7faeb400b240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7faeb49a1750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7faeb44acc90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7faeb49a1750>
             └ {'function': <function bot_start at 0x7faeb2ed5a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7faeb49a1750>
    └ <function save_user at 0x7faeb2e77560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7faeb407f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7faeb4020d90>
           │      └ <peewee.ModelInsert object at 0x7faeb4020790>
           └ <function BaseQuery.execute at 0x7faeb4052520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7faeb4020d90>
           │    └ <function Insert._execute at 0x7faeb4057b00>
           └ <peewee.ModelInsert object at 0x7faeb4020790>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7faeb4020d90>
                 │       └ <peewee.ModelInsert object at 0x7faeb4020790>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7faeb4020790>
             │        └ <function Database.execute at 0x7faeb405a700>
             └ <peewee.SqliteDatabase object at 0x7faeb4020d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7faeb5384d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7faeb405a660>
           └ <peewee.SqliteDatabase object at 0x7faeb4020d90>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7faeb405c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7faeb2f01b40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7faeb44c6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7faeb2f01b40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7faeb2ee2f40>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:45:59.843453+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (9566), thread 'WorkerThread1' (140191422428864):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f80dae931c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f80dd1df240>
    └ <WorkerThread(WorkerThread1, started daemon 140191422428864)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f80dd098720>
    └ <WorkerThread(WorkerThread1, started daemon 140191422428864)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f80dbfbf240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f80dd1f6750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f80dc464d90>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f80dd1f6750>
             └ {'function': <function bot_start at 0x7f80dae85a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f80dd1f6750>
    └ <function save_user at 0x7f80dae27560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f80dc037740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f80dbfd4d10>
           │      └ <peewee.ModelInsert object at 0x7f80daeada50>
           └ <function BaseQuery.execute at 0x7f80dc00a520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f80dbfd4d10>
           │    └ <function Insert._execute at 0x7f80dc00fb00>
           └ <peewee.ModelInsert object at 0x7f80daeada50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f80dbfd4d10>
                 │       └ <peewee.ModelInsert object at 0x7f80daeada50>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f80daeada50>
             │        └ <function Database.execute at 0x7f80dc012700>
             └ <peewee.SqliteDatabase object at 0x7f80dbfd4d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f80dd384d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f80dc012660>
           └ <peewee.SqliteDatabase object at 0x7f80dbfd4d10>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f80dc014370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f80dd06f940>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f80dc47e840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f80dd06f940>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f80dae931c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:48:29.346543+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (9656), thread 'WorkerThread1' (140432786867904):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb90d59f8c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fb90f8e3240>
    └ <WorkerThread(WorkerThread1, started daemon 140432786867904)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fb90f79c720>
    └ <WorkerThread(WorkerThread1, started daemon 140432786867904)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fb90e6cb240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fb90d5a2010>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fb9102ec090>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fb90d5a2010>
             └ {'function': <function bot_start at 0x7fb90d591a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fb90d5a2010>
    └ <function save_user at 0x7fb90d533560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fb90e73f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
           │      └ <peewee.ModelInsert object at 0x7fb90f18bc50>
           └ <function BaseQuery.execute at 0x7fb90e712520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
           │    └ <function Insert._execute at 0x7fb90e717b00>
           └ <peewee.ModelInsert object at 0x7fb90f18bc50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
                 │       └ <peewee.ModelInsert object at 0x7fb90f18bc50>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fb90f18bc50>
             │        └ <function Database.execute at 0x7fb90e71a700>
             └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fb9102d4d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fb90e71a660>
           └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fb90e71c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fb90d5c0a40>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fb90eba6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fb90d5c0a40>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb90d59f8c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:48:29.347840+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (9656), thread 'WorkerThread2' (140432778475200):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb90d59f9c0>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fb90f8e3240>
    └ <WorkerThread(WorkerThread2, started daemon 140432778475200)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7fb90f79c720>
    └ <WorkerThread(WorkerThread2, started daemon 140432778475200)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7fb90e6cb240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7fb90d5bd750>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7fb9102ec090>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7fb90d5bd750>
             └ {'function': <function bot_start at 0x7fb90d591a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7fb90d5bd750>
    └ <function save_user at 0x7fb90d533560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7fb90e73f740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
           │      └ <peewee.ModelInsert object at 0x7fb90d5c0390>
           └ <function BaseQuery.execute at 0x7fb90e712520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
           │    └ <function Insert._execute at 0x7fb90e717b00>
           └ <peewee.ModelInsert object at 0x7fb90d5c0390>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
                 │       └ <peewee.ModelInsert object at 0x7fb90d5c0390>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7fb90d5c0390>
             │        └ <function Database.execute at 0x7fb90e71a700>
             └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7fb9102d4d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7fb90e71a660>
           └ <peewee.SqliteDatabase object at 0x7fb90e6e0c50>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7fb90e71c370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7fb90cc11140>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7fb90eba6840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7fb90cc11140>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7fb90d59f9c0>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:50:15.477974+0700, ERROR, An error has been caught in function 'bot_start', process 'MainProcess' (9692), thread 'WorkerThread1' (140237183362752):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f8b827a7240>

sqlite3.IntegrityError: NOT NULL constraint failed: users.name


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f8b84ae3240>
    └ <WorkerThread(WorkerThread1, started daemon 140237183362752)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f8b8499c720>
    └ <WorkerThread(WorkerThread1, started daemon 140237183362752)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function get_city_incorrect at 0x7f8b838cf240>, 'pass_bot': False, 'filters': {'content_types': [...
    │     └ (<telebot.types.Message object at 0x7f8b827c4890>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f8b83d90e50>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.Message object at 0x7f8b827c4890>
             └ {'function': <function bot_start at 0x7f8b82799a80>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'commands': ['...

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/default_heandlers/start.py", line 16, in bot_start
    save_user(message)
    │         └ <telebot.types.Message object at 0x7f8b827c4890>
    └ <function save_user at 0x7f8b8273b560>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 32, in save_user
    User(name=username).save()
    │         └ None
    └ <Model: User>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'name': None}
         │    └ <classmethod(<function Model.insert at 0x7f8b83943740>)>
         └ <User: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
           │      └ <peewee.ModelInsert object at 0x7f8b839ac6d0>
           └ <function BaseQuery.execute at 0x7f8b83916520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
           │    └ <function Insert._execute at 0x7f8b8391bb00>
           └ <peewee.ModelInsert object at 0x7f8b839ac6d0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
                 │       └ <peewee.ModelInsert object at 0x7f8b839ac6d0>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f8b839ac6d0>
             │        └ <function Database.execute at 0x7f8b8391e700>
             └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f8b854c8d10>
           │    │           │    └ [None]
           │    │           └ 'INSERT INTO "users" ("name") VALUES (?)'
           │    └ <function Database.execute_sql at 0x7f8b8391e660>
           └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f8b83920370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f8b827c7700>
    │       │         │        │           └ ('NOT NULL constraint failed: users.name',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: users.name')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f8b83daa840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f8b827c7700>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: users.name')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [None]
    │      │       └ 'INSERT INTO "users" ("name") VALUES (?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f8b827a7240>

peewee.IntegrityError: NOT NULL constraint failed: users.name
2023-06-10T16:55:14.713639+0700, ERROR, An error has been caught in function 'date_reply', process 'MainProcess' (9692), thread 'WorkerThread2' (140237174970048):
Traceback (most recent call last):

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686390914.71059, 'highprice', 'Лондон, Англия, Великобритания', datetime.date(2023, 8, 2), datetime.date(2023, 8, 16), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f8b827a6440>

sqlite3.IntegrityError: NOT NULL constraint failed: histories.from_user_id


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f8b84ae3240>
    └ <WorkerThread(WorkerThread2, started daemon 140237174970048)>
  File "/usr/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x7f8b8499c720>
    └ <WorkerThread(WorkerThread2, started daemon 140237174970048)>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/util.py", line 90, in run
    task(*args, **kwargs)
    │     │       └ {'handlers': [{'function': <function pages_callback at 0x7f8b827498a0>, 'pass_bot': False, 'filters': {'func': <function <lam...
    │     └ (<telebot.types.CallbackQuery object at 0x7f8b81d62a90>,)
    └ <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x7f8b83d90e50>>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/telebot/__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             │                   └ <telebot.types.CallbackQuery object at 0x7f8b81d62a90>
             └ {'function': <function date_reply at 0x7f8b82792f20>, 'pass_bot': False, 'filters': {'func': <function TelegramCalendar.func....

> File "/home/igor/PycharmProjects/PythonBOT_NEW/handlers/survey_handlers.py", line 196, in date_reply
    low_high_price_answer(call.message, data_dict, call.from_user.username)
    │                     │    │        │          │    │         └ None
    │                     │    │        │          │    └ <telebot.types.User object at 0x7f8b81e7aa10>
    │                     │    │        │          └ <telebot.types.CallbackQuery object at 0x7f8b81d62a90>
    │                     │    │        └ {'last_command': 'highprice', 'cities': {'Лондон, Англия, Великобритания': '2114'}, 'city_id': '2114', 'city': 'Лондон, Англи...
    │                     │    └ <telebot.types.Message object at 0x7f8b81d62c90>
    │                     └ <telebot.types.CallbackQuery object at 0x7f8b81d62a90>
    └ <function low_high_price_answer at 0x7f8b8274b100>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/utils/ready_for_answer.py", line 38, in low_high_price_answer
    show_info(message=message, request_data=data, result_data=result_dict, user=user,
    │                 │                     │                 │                 └ None
    │                 │                     │                 └ {'54987': {'name': 'Royal Garden Hotel', 'price_per_night': 268.21, 'total_price': '$4,506 total', 'distance_city_center': 4....
    │                 │                     └ {'last_command': 'highprice', 'cities': {'Лондон, Англия, Великобритания': '2114'}, 'city_id': '2114', 'city': 'Лондон, Англи...
    │                 └ <telebot.types.Message object at 0x7f8b81d62c90>
    └ <function show_info at 0x7f8b8274bce0>

  File "/home/igor/PycharmProjects/PythonBOT_NEW/database/db_controller.py", line 54, in wrapped_func
    ).save()

  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 6718, in save
    pk = self.insert(**field_dict).execute()
         │    │        └ {'date': 1686390914.71059, 'command': 'highprice', 'city': 'Лондон, Англия, Великобритания', 'start_date': datetime.date(2023...
         │    └ <classmethod(<function Model.insert at 0x7f8b83943740>)>
         └ <History: None>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 1946, in inner
    return method(self, database, *args, **kwargs)
           │      │     │          │       └ {}
           │      │     │          └ ()
           │      │     └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
           │      └ <peewee.ModelInsert object at 0x7f8b81e7e790>
           └ <function BaseQuery.execute at 0x7f8b83916520>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2017, in execute
    return self._execute(database)
           │    │        └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
           │    └ <function Insert._execute at 0x7f8b8391bb00>
           └ <peewee.ModelInsert object at 0x7f8b81e7e790>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2822, in _execute
    return super(Insert, self)._execute(database)
                 │       │              └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
                 │       └ <peewee.ModelInsert object at 0x7f8b81e7e790>
                 └ <class 'peewee.Insert'>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2535, in _execute
    cursor = database.execute(self)
             │        │       └ <peewee.ModelInsert object at 0x7f8b81e7e790>
             │        └ <function Database.execute at 0x7f8b8391e700>
             └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3234, in execute
    return self.execute_sql(sql, params, commit=commit)
           │    │           │    │              └ <object object at 0x7f8b854c8d10>
           │    │           │    └ [1686390914.71059, 'highprice', 'Лондон, Англия, Великобритания', datetime.date(2023, 8, 2), datetime.date(2023, 8, 16), None]
           │    │           └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
           │    └ <function Database.execute_sql at 0x7f8b8391e660>
           └ <peewee.SqliteDatabase object at 0x7f8b838e4ed0>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3218, in execute_sql
    with __exception_wrapper__:
         └ <peewee.ExceptionWrapper object at 0x7f8b83920370>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 2994, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
    │       │         │        │           │          └ <traceback object at 0x7f8b81e7a800>
    │       │         │        │           └ ('NOT NULL constraint failed: histories.from_user_id',)
    │       │         │        └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
    │       │         └ <class 'peewee.IntegrityError'>
    │       └ <class 'peewee.IntegrityError'>
    └ <function reraise at 0x7f8b83daa840>
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 191, in reraise
    raise value.with_traceback(tb)
          │     │              └ <traceback object at 0x7f8b81e7a800>
          │     └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('NOT NULL constraint failed: histories.from_user_id')
  File "/home/igor/PycharmProjects/PythonBOT_NEW/venv/lib/python3.11/site-packages/peewee.py", line 3221, in execute_sql
    cursor.execute(sql, params or ())
    │      │       │    └ [1686390914.71059, 'highprice', 'Лондон, Англия, Великобритания', datetime.date(2023, 8, 2), datetime.date(2023, 8, 16), None]
    │      │       └ 'INSERT INTO "histories" ("date", "command", "city", "start_date", "end_date", "from_user_id") VALUES (?, ?, ?, ?, ?, ?)'
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x7f8b827a6440>

peewee.IntegrityError: NOT NULL constraint failed: histories.from_user_id
2023-08-02T22:40:42.575077+0700, ERROR, An error has been caught in function 'best_deal_answer', process 'MainProcess' (11444), thread 'WorkerThread1' (3124):
Traceback (most recent call last):

  File "C:\Python\Lib\threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
    |    -> <function Thread._bootstrap_inner at 0x00000213193747C0>
    -> <WorkerThread(WorkerThread1, started daemon 3124)>
  File "C:\Python\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
    |    -> <function WorkerThread.run at 0x000002131964DF80>
    -> <WorkerThread(WorkerThread1, started daemon 3124)>
  File "C:\Users\video\PycharmProjects\project-bot-diploma\venv\Lib\site-packages\telebot\util.py", line 90, in run
    task(*args, **kwargs)
    |     |       -> {'handlers': [{'function': <function get_city_incorrect at 0x000002131C47C540>, 'pass_bot': False, 'filters': {'content_types...
    |     -> (<telebot.types.Message object at 0x000002131C57F110>,)
    -> <bound method TeleBot._run_middlewares_and_handler of <telebot.TeleBot object at 0x000002131B9FFF90>>
  File "C:\Users\video\PycharmProjects\project-bot-diploma\venv\Lib\site-packages\telebot\__init__.py", line 6770, in _run_middlewares_and_handler
    result = handler['function'](message)
             |                   -> <telebot.types.Message object at 0x000002131C57F110>
             -> {'function': <function get_end_distance at 0x000002131C56A660>, 'pass_bot': False, 'filters': {'content_types': ['text'], 'st...

  File "C:\Users\video\PycharmProjects\project-bot-diploma\handlers\survey_handlers.py", line 282, in get_end_distance
    best_deal_answer(message, data_dict, message.from_user.username)
    |                |        |          |       |         -> 'HelloWonderWorld'
    |                |        |          |       -> <telebot.types.User object at 0x000002131C485710>
    |                |        |          -> <telebot.types.Message object at 0x000002131C57F110>
    |                |        -> {'last_command': 'bestdeal', 'cities': {', ': '2734', ', , ': '9408', ', , ': '9474'...
    |                -> <telebot.types.Message object at 0x000002131C57F110>
    -> <function best_deal_answer at 0x000002131C5320C0>

> File "C:\Users\video\PycharmProjects\project-bot-diploma\utils\ready_for_answer.py", line 79, in best_deal_answer
    hotels = parse_hotels(data)
             |            -> {'last_command': 'bestdeal', 'cities': {', ': '2734', ', , ': '9408', ', , ': '9474'...
             -> <function parse_hotels at 0x000002131C4DBBA0>

  File "C:\Users\video\PycharmProjects\project-bot-diploma\utils\get_hotels.py", line 77, in parse_hotels
    data = json.loads(response.text)
           |    |     -> None
           |    -> <function loads at 0x000002131AE69A80>
           -> <module 'json' from 'C:\\Python\\Lib\\json\\__init__.py'>

AttributeError: 'NoneType' object has no attribute 'text'
